!function(){"use strict";window.initDragTheWords=function(e){if(!e)return;const t=e.getAttribute("data-drag-words-config");if(!t)return;const r=JSON.parse(t),n=(e.querySelector(".text-content"),e.querySelector(".word-bank-items")),o=e.querySelector(".drag-words-check"),a=e.querySelector(".drag-words-retry"),s=e.querySelector(".drag-words-solution"),l=e.querySelector(".drag-words-results"),d=e.querySelector(".result-message"),c=e.querySelector(".score-display");let i=null,u=!1,p={},g=null,f=null;const m=e.querySelectorAll(".word-blank");function y(e){u||(i=e.target,e.target.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target.innerHTML))}function b(e){e.target.classList.remove("dragging")}function v(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",e.target.classList.add("drag-over"),!1}function w(e){e.target.classList.remove("drag-over")}function h(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault();const t=e.target.closest(".word-blank");if(!t||!i)return;t.classList.remove("drag-over");const o=parseInt(t.getAttribute("data-blank")),a=i.getAttribute("data-word"),s=i;p[o].element&&S(p[o].element);const l=A(a);return t.appendChild(l),p[o]={word:a,element:l,correctWord:p[o].correctWord},r.enableWordReuse||s.parentNode!==n||s.remove(),i=null,!1}function E(e){if(u)return;g=e.target,i=e.target;const t=e.touches[0],r=g.cloneNode(!0);r.style.position="fixed",r.style.left=t.pageX-25+"px",r.style.top=t.pageY-15+"px",r.style.opacity="0.7",r.style.pointerEvents="none",r.style.zIndex="10000",document.body.appendChild(r),f=r,g.style.opacity="0.3"}function L(e){if(!g||!f)return;e.preventDefault();const t=e.touches[0];f.style.left=t.pageX-25+"px",f.style.top=t.pageY-15+"px"}function x(e){if(!g)return;const t=e.changedTouches[0],o=document.elementFromPoint(t.clientX,t.clientY),a=o?o.closest(".word-blank"):null;if(a){const e=parseInt(a.getAttribute("data-blank")),t=g.getAttribute("data-word");p[e].element&&S(p[e].element),r.enableWordReuse||g.parentNode!==n||g.remove();const o=A(t);a.appendChild(o),p[e]={word:t,element:o,correctWord:p[e].correctWord}}else g.style.opacity="1";f&&f.parentNode&&f.remove(),g=null,f=null,i=null}function k(e){if(u)return;const t=e.target.closest(".word-blank");if(!t)return;const r=parseInt(t.getAttribute("data-blank")),n=p[r];n.element&&(S(n.element),p[r]={word:null,element:null,correctWord:n.correctWord})}function A(e){const t=document.createElement("span");return t.className="word-in-blank",t.textContent=e,t.setAttribute("data-word",e),t.style.cssText="display: inline-block; padding: 6px 12px; background: #ffffff; border: 2px solid #cccccc; border-radius: 4px; color: #1e1e1e; font-weight: 500; cursor: pointer;",t}function S(e){if(!r.enableWordReuse){const t=e.getAttribute("data-word"),r=document.createElement("div");r.className="draggable-word",r.textContent=t,r.setAttribute("data-word",t),r.setAttribute("draggable","true"),r.style.cssText="display: inline-block; padding: 8px 16px; background: #e8e8e8; border: 2px solid #cccccc; border-radius: 4px; color: #1e1e1e; font-weight: 500; cursor: move;",r.addEventListener("dragstart",y),r.addEventListener("dragend",b),r.addEventListener("touchstart",E,{passive:!1}),r.addEventListener("touchmove",L,{passive:!1}),r.addEventListener("touchend",x,{passive:!1}),n.appendChild(r)}e&&e.parentNode&&e.remove()}m.forEach((e,t)=>{const r=e.getAttribute("data-correct-word");p[t]={word:null,element:null,correctWord:r}}),e.querySelectorAll(".draggable-word").forEach(e=>{e.addEventListener("dragstart",y),e.addEventListener("dragend",b),e.addEventListener("touchstart",E,{passive:!1}),e.addEventListener("touchmove",L,{passive:!1}),e.addEventListener("touchend",x,{passive:!1})}),m.forEach(e=>{e.addEventListener("dragover",v),e.addEventListener("drop",h),e.addEventListener("dragleave",w),e.addEventListener("click",k)}),o&&o.addEventListener("click",function(){u=!0;let t=0,n=m.length;m.forEach((e,n)=>{const o=p[n],a=o.correctWord;if(o.element&&a){const e=o.word,n=r.caseSensitive?e===a:e.toLowerCase()===a.toLowerCase();o.element.classList.remove("correct","incorrect"),o.element.classList.add(n?"correct":"incorrect"),n&&t++}}),function(e,t){if(!l||!r.showScore)return;l.style.display="block";const n=e/t*100;let o="";if(o=100===n?r.successText:n>=50?r.partialSuccessText:r.failText,d&&(d.textContent=o),c){const n=r.scoreText.replace("@score",e).replace("@total",t);c.textContent=n}}(t,n),e.querySelectorAll(".draggable-word, .word-in-blank").forEach(e=>{e.setAttribute("draggable","false"),e.style.cursor="default"}),o.style.display="none",a&&(a.style.display="inline-block"),s&&(s.style.display="inline-block")}),a&&a.addEventListener("click",function(){if(u=!1,m.forEach((e,t)=>{const r=p[t];r.element&&(S(r.element),p[t]={word:null,element:null})}),r.randomizeWords){const e=Array.from(n.children);e.sort(()=>Math.random()-.5),e.forEach(e=>n.appendChild(e))}e.querySelectorAll(".draggable-word").forEach(e=>{e.setAttribute("draggable","true"),e.style.cursor="move",e.classList.remove("correct","incorrect")}),l&&(l.style.display="none"),o.style.display="inline-block",a&&(a.style.display="none"),s&&(s.style.display="none")}),s&&s.addEventListener("click",function(){m.forEach((e,t)=>{const r=p[t];r.element&&r.element.remove();const n=e.getAttribute("data-correct-word");if(n){const r=document.createElement("span");r.className="word-in-blank solution correct",r.textContent=n,r.setAttribute("data-word",n),e.appendChild(r),p[t]={word:n,element:r,correctWord:n}}}),n.innerHTML="",l&&r.showScore&&(l.style.display="block",d&&(d.textContent="LÃ¶sung wird angezeigt."),c&&(c.textContent="")),s&&(s.style.display="none")})},document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".wp-block-modular-blocks-drag-the-words").forEach(e=>{window.initDragTheWords(e)})})}();