!function(){"use strict";window.initDragTheWords=function(e){if(!e)return;const t=e.getAttribute("data-drag-words-config");if(!t)return;const r=JSON.parse(t),n=(e.querySelector(".text-content"),e.querySelector(".word-bank-items")),o=e.querySelector(".drag-words-check"),l=e.querySelector(".drag-words-retry"),s=e.querySelector(".drag-words-solution"),a=e.querySelector(".drag-words-results"),c=e.querySelector(".result-message"),d=e.querySelector(".score-display");let i=null,u=!1,p={},f=null,g=null,y=null,v=0,b=!1;const m=e.querySelectorAll(".word-blank");function w(e){u||(i=e.target,e.target.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target.innerHTML))}function h(e){e.target.classList.remove("dragging")}function L(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",e.target.classList.add("drag-over"),!1}function k(e){e.target.classList.remove("drag-over")}function E(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault();const t=e.target.closest(".word-blank");if(!t||!i)return;t.classList.remove("drag-over");const r=parseInt(t.getAttribute("data-blank"));return W(i,t,r),i=null,!1}function x(e){if(u)return;e.stopPropagation();const t=e.target;y&&y!==t&&y.classList.remove("selected"),y===t?(t.classList.remove("selected"),y=null):(t.classList.add("selected"),y=t)}function A(e){if(u)return;f=e.target,i=e.target,v=Date.now(),b=!1;const t=e.touches[0],r=f.cloneNode(!0);r.style.position="fixed",r.style.left=t.pageX-25+"px",r.style.top=t.pageY-15+"px",r.style.opacity="0.7",r.style.pointerEvents="none",r.style.zIndex="10000",document.body.appendChild(r),g=r,f.style.opacity="0.3"}function C(e){if(!f||!g)return;e.preventDefault(),b=!0;const t=e.touches[0];g.style.left=t.pageX-25+"px",g.style.top=t.pageY-15+"px"}function S(e){if(!f)return;const t=Date.now()-v,r=e.changedTouches[0],n=document.elementFromPoint(r.clientX,r.clientY),o=n?n.closest(".word-blank"):null;if(t<200&&!b)return g&&g.parentNode&&g.remove(),f.style.opacity="1",f.click(),f=null,g=null,void(i=null);if(o){const e=parseInt(o.getAttribute("data-blank"));W(f,o,e)}else f.style.opacity="1";g&&g.parentNode&&g.remove(),f=null,g=null,i=null}function T(e){if(u)return;let t=null;if(t=e.target.classList.contains("word-in-blank")?e.target:e.target.closest(".word-in-blank"),t){const e=t.closest(".word-blank");if(e){const t=parseInt(e.getAttribute("data-blank")),r=p[t];r.element&&D(r.element,t)}return}const r=e.target.closest(".word-blank");if(!r)return;const n=parseInt(r.getAttribute("data-blank")),o=p[n];if(y)return W(y,r,n),y.classList.remove("selected"),void(y=null);o.element&&D(o.element,n)}function q(e){if(u)return;if(!y)return;e.preventDefault(),e.stopPropagation();const t=e.target.closest(".word-blank");if(!t)return;const r=parseInt(t.getAttribute("data-blank"));W(y,t,r),y.classList.remove("selected"),y=null}function W(e,t,r){const n=e.getAttribute("data-word");p[r].element&&D(p[r].element,r),e.parentNode&&e.parentNode.removeChild(e),e.className="word-in-blank",e.style.cssText="display: inline-block; padding: 6px 12px; background: #ffffff; border: 2px solid #cccccc; border-radius: 4px; color: #1e1e1e; font-weight: 500; cursor: pointer;",e.setAttribute("draggable","false"),e.addEventListener("click",function(t){u||(t.stopPropagation(),D(e,r))}),t.appendChild(e),p[r]={word:n,element:e,correctWord:p[r].correctWord}}function D(e,t){e&&e.parentNode&&e.parentNode.removeChild(e),e.className="draggable-word",e.style.cssText="display: inline-block; padding: 8px 16px; background: #e8e8e8; border: 2px solid #cccccc; border-radius: 4px; color: #1e1e1e; font-weight: 500; cursor: move;",e.setAttribute("draggable","true"),e.classList.remove("correct","incorrect","selected"),n.appendChild(e),void 0!==t&&(p[t]={word:null,element:null,correctWord:p[t].correctWord})}m.forEach((e,t)=>{const r=e.getAttribute("data-correct-word");p[t]={word:null,element:null,correctWord:r}}),e.querySelectorAll(".draggable-word").forEach(e=>{e.addEventListener("dragstart",w),e.addEventListener("dragend",h),e.addEventListener("touchstart",A,{passive:!1}),e.addEventListener("touchmove",C,{passive:!1}),e.addEventListener("touchend",S,{passive:!1}),e.addEventListener("click",x)}),m.forEach(e=>{e.addEventListener("dragover",L),e.addEventListener("drop",E),e.addEventListener("dragleave",k),e.addEventListener("click",T),e.addEventListener("touchend",q,{passive:!1})}),o&&o.addEventListener("click",function(){u=!0;let t=0,n=m.length;m.forEach((e,n)=>{const o=p[n],l=o.correctWord;if(o.element&&l){const e=o.word,n=r.caseSensitive?e===l:e.toLowerCase()===l.toLowerCase();o.element.classList.remove("correct","incorrect"),o.element.classList.add(n?"correct":"incorrect"),n&&t++}}),function(e,t){if(!a||!r.showScore)return;a.style.display="block";const n=e/t*100;let o="";if(o=100===n?r.successText:n>=50?r.partialSuccessText:r.failText,c&&(c.textContent=o),d){const n=r.scoreText.replace("@score",e).replace("@total",t);d.textContent=n}}(t,n),e.querySelectorAll(".draggable-word, .word-in-blank").forEach(e=>{e.setAttribute("draggable","false"),e.style.cursor="default"}),o.style.display="none",l&&(l.style.display="inline-block"),s&&(s.style.display="inline-block")}),l&&l.addEventListener("click",function(){if(u=!1,y&&(y.classList.remove("selected"),y=null),m.forEach((e,t)=>{const r=p[t];r.element&&D(r.element,t)}),r.randomizeWords){const e=Array.from(n.children);e.sort(()=>Math.random()-.5),e.forEach(e=>n.appendChild(e))}e.querySelectorAll(".draggable-word").forEach(e=>{e.setAttribute("draggable","true"),e.style.cursor="move",e.classList.remove("correct","incorrect","selected")}),a&&(a.style.display="none"),o.style.display="inline-block",l&&(l.style.display="none"),s&&(s.style.display="none")}),s&&s.addEventListener("click",function(){n.innerHTML="",m.forEach((e,t)=>{for(;e.firstChild;)e.removeChild(e.firstChild);p[t]={word:null,element:null,correctWord:p[t].correctWord};const r=e.getAttribute("data-correct-word");if(r){const n=document.createElement("span");n.className="word-in-blank solution correct",n.textContent=r,n.setAttribute("data-word",r),e.appendChild(n),p[t]={word:r,element:n,correctWord:r}}}),a&&r.showScore&&(a.style.display="block",c&&(c.textContent="LÃ¶sung wird angezeigt."),d&&(d.textContent="")),s&&(s.style.display="none")})},document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".wp-block-modular-blocks-drag-the-words").forEach(e=>{window.initDragTheWords(e)})})}();