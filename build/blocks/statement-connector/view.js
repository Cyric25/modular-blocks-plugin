!function(){"use strict";window.initStatementConnector=function(t){if(!t)return;const e=t.getAttribute("data-connector-config");if(!e)return;const n=JSON.parse(e),o=t.querySelector(".connector-canvas"),i=t.querySelectorAll(".left-item"),c=t.querySelectorAll(".right-item"),r=t.querySelector(".connector-check"),s=t.querySelector(".connector-retry"),l=t.querySelector(".connector-solution"),u=t.querySelector(".connector-results"),a=t.querySelector(".result-message"),d=t.querySelector(".score-display");let m=[],f=!1,y=null,h=null,p=!1;function g(t,e,i){if(p)return;t.preventDefault(),f=!0,h={element:e,side:i},y=document.createElementNS("http://www.w3.org/2000/svg","line");const c=w(e.querySelector(".connection-point"));y.setAttribute("x1",c.x),y.setAttribute("y1",c.y),y.setAttribute("x2",c.x),y.setAttribute("y2",c.y),y.setAttribute("stroke","#0073aa"),y.setAttribute("stroke-width",n.lineWidth),y.classList.add("temp-line"),o.appendChild(y)}function b(t){if(!f||!y)return;const e=o.getBoundingClientRect();let n,i;if(t.type.startsWith("touch")){const e=t.touches[0];n=e.clientX,i=e.clientY}else n=t.clientX,i=t.clientY;const c=n-e.left,r=i-e.top;y.setAttribute("x2",c),y.setAttribute("y2",r)}function A(e){if(!f)return;f=!1;const i=document.elementFromPoint(e.clientX||e.changedTouches[0].clientX,e.clientY||e.changedTouches[0].clientY),c=i?.closest(".connection-point"),r=c?.closest(".connector-item");if(r&&r!==h.element){const e=r.classList.contains("left-item")?"left":"right";h.side!==e&&function(e,i){const c=e.getAttribute("data-item-id"),r=i.getAttribute("data-item-id"),s=m.findIndex(t=>t.from===c&&t.to===r||t.from===r&&t.to===c);s>-1&&!n.allowMultipleConnections&&m.splice(s,1);const l=e.classList.contains("left-item")?c:r,u=e.classList.contains("left-item")?r:c;n.allowMultipleConnections||(m=m.filter(t=>t.from!==l)),m.push({from:l,to:u}),S(),n.instantFeedback&&function(e,n){const i=t.querySelector(`[data-item-id="${n}"]`),c=i?.getAttribute("data-correct-connection"),r=o.querySelector(`[data-from="${e}"][data-to="${n}"]`);if(r){const t=c===e;r.setAttribute("stroke",t?"#00a32a":"#d63638"),r.classList.add(t?"correct":"incorrect")}}(l,u)}(h.element,r)}y&&(y.remove(),y=null),h=null}function S(){o.querySelectorAll("line:not(.temp-line)").forEach(t=>t.remove()),m.forEach((e,i)=>{const c=t.querySelector(`[data-item-id="${e.from}"]`),r=t.querySelector(`[data-item-id="${e.to}"]`);c&&r&&function(t,e,i){const c=t.querySelector(".connection-point"),r=e.querySelector(".connection-point"),s=w(c),l=w(r),u=document.createElementNS("http://www.w3.org/2000/svg","line");u.setAttribute("x1",s.x),u.setAttribute("y1",s.y),u.setAttribute("x2",l.x),u.setAttribute("y2",l.y),u.setAttribute("stroke","#0073aa"),u.setAttribute("stroke-width",n.lineWidth),u.setAttribute("data-from",i.from),u.setAttribute("data-to",i.to),n.animateConnections&&u.classList.add("animated"),o.appendChild(u)}(c,r,e)})}function w(t){const e=o.getBoundingClientRect(),n=t.getBoundingClientRect();return{x:n.left+n.width/2-e.left,y:n.top+n.height/2-e.top}}!function(){const t=o.parentElement,e=t.getBoundingClientRect();o.setAttribute("width",e.width),o.setAttribute("height",e.height),window.addEventListener("resize",()=>{const e=t.getBoundingClientRect();o.setAttribute("width",e.width),o.setAttribute("height",e.height),S()})}(),i.forEach(t=>{const e=t.querySelector(".connection-point");e.addEventListener("mousedown",e=>g(e,t,"left")),e.addEventListener("touchstart",e=>g(e,t,"left"))}),c.forEach(t=>{const e=t.querySelector(".connection-point");e.addEventListener("mousedown",e=>g(e,t,"right")),e.addEventListener("touchstart",e=>g(e,t,"right"))}),document.addEventListener("mousemove",b),document.addEventListener("touchmove",b),document.addEventListener("mouseup",A),document.addEventListener("touchend",A),r&&r.addEventListener("click",function(){p=!0;let e=0,i=n.rightColumn.items.length;m.forEach(n=>{const i=t.querySelector(`[data-item-id="${n.to}"]`),c=i?.getAttribute("data-correct-connection"),r=c===n.from,s=o.querySelector(`[data-from="${n.from}"][data-to="${n.to}"]`);s&&(s.setAttribute("stroke",r?"#00a32a":"#d63638"),s.classList.add(r?"correct":"incorrect")),r&&e++}),function(t,e){if(!u)return;u.style.display="block";const o=e>0?t/e*100:0;let i="";i=100===o?n.successText:o>=50?n.partialSuccessText:n.failText,a&&(a.textContent=i),d&&(d.textContent=`${t} von ${e} richtig`)}(e,i),r.style.display="none",s&&(s.style.display="inline-block"),l&&(l.style.display="inline-block")}),s&&s.addEventListener("click",function(){p=!1,m=[],S(),u&&(u.style.display="none"),r.style.display="inline-block",s&&(s.style.display="none"),l&&(l.style.display="none")}),l&&l.addEventListener("click",function(){m=[],n.rightColumn.items.forEach(t=>{t.correctConnection&&m.push({from:t.correctConnection,to:t.id})}),S(),o.querySelectorAll("line").forEach(t=>{t.setAttribute("stroke","#00a32a"),t.classList.add("correct","solution")}),u&&(u.style.display="block",a&&(a.textContent="LÃ¶sung wird angezeigt."),d&&(d.textContent="")),l&&(l.style.display="none")})},document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".wp-block-modular-blocks-statement-connector").forEach(t=>{window.initStatementConnector(t)})})}();