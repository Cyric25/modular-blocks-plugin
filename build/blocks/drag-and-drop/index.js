(()=>{"use strict";var e={20:(e,l,t)=>{var n=t(609),a=Symbol.for("react.element"),o=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};l.jsx=function(e,l,t){var n,c={},s=null,d=null;for(n in void 0!==t&&(s=""+t),void 0!==l.key&&(s=""+l.key),void 0!==l.ref&&(d=l.ref),l)o.call(l,n)&&!i.hasOwnProperty(n)&&(c[n]=l[n]);if(e&&e.defaultProps)for(n in l=e.defaultProps)void 0===c[n]&&(c[n]=l[n]);return{$$typeof:a,type:e,key:s,ref:d,props:c,_owner:r.current}}},609:e=>{e.exports=window.React},848:(e,l,t)=>{e.exports=t(20)}},l={};function t(n){var a=l[n];if(void 0!==a)return a.exports;var o=l[n]={exports:{}};return e[n](o,o.exports,t),o.exports}var n=t(609);const a=window.wp.blocks,o=window.wp.blockEditor,r=window.wp.components,i=window.wp.i18n,c=window.wp.primitives;var s=t(848);const d=(0,s.jsx)(c.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,s.jsx)(c.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})}),u=(0,s.jsx)(c.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,s.jsx)(c.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),m=(0,s.jsx)(c.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,s.jsx)(c.Path,{d:"M19.75 9c0-1.257-.565-2.197-1.39-2.858-.797-.64-1.827-1.017-2.815-1.247-1.802-.42-3.703-.403-4.383-.396L11 4.5V6l.177-.001c.696-.006 2.416-.02 4.028.356.887.207 1.67.518 2.216.957.52.416.829.945.829 1.688 0 .592-.167.966-.407 1.23-.255.281-.656.508-1.236.674-1.19.34-2.82.346-4.607.346h-.077c-1.692 0-3.527 0-4.942.404-.732.209-1.424.545-1.935 1.108-.526.579-.796 1.33-.796 2.238 0 1.257.565 2.197 1.39 2.858.797.64 1.827 1.017 2.815 1.247 1.802.42 3.703.403 4.383.396L13 19.5h.714V22L18 18.5 13.714 15v3H13l-.177.001c-.696.006-2.416.02-4.028-.356-.887-.207-1.67-.518-2.216-.957-.52-.416-.829-.945-.829-1.688 0-.592.167-.966.407-1.23.255-.281.656-.508 1.237-.674 1.189-.34 2.819-.346 4.606-.346h.077c1.692 0 3.527 0 4.941-.404.732-.209 1.425-.545 1.936-1.108.526-.579.796-1.33.796-2.238z"})}),g=window.wp.element;(0,a.registerBlockType)("modular-blocks/drag-and-drop",{edit:({attributes:e,setAttributes:l})=>{const{title:t,description:a,backgroundImage:c,draggables:s,dropZones:p,showFeedback:b,showRetry:h,showSolution:k,instantFeedback:_,enableSnap:E,showScore:x,randomizeDraggables:v,allowPartialScore:y,backgroundHeight:C,scoreText:w,successText:f,partialSuccessText:T,failText:S}=e,B=(0,o.useBlockProps)(),[z,N]=(0,g.useState)(null),P=(0,g.useRef)(null),D=(e,t,n)=>{const a=[...s];a[e]={...a[e],[t]:n},l({draggables:a})},Z=(e,t,n)=>{const a=[...p];a[e]={...a[e],[t]:n},l({dropZones:a})};return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(o.InspectorControls,null,(0,n.createElement)(r.PanelBody,{title:(0,i.__)("Hintergrundbild","modular-blocks-plugin")},(0,n.createElement)(o.MediaUploadCheck,null,(0,n.createElement)(o.MediaUpload,{onSelect:e=>{l({backgroundImage:{url:e.url,alt:e.alt,id:e.id}})},allowedTypes:["image"],value:c.id,render:({open:e})=>(0,n.createElement)(r.Button,{onClick:e,variant:"secondary"},c.url?(0,i.__)("Bild ändern","modular-blocks-plugin"):(0,i.__)("Bild auswählen","modular-blocks-plugin"))})),c.url&&(0,n.createElement)(r.Button,{onClick:()=>{l({backgroundImage:{url:"",alt:"",id:null}})},variant:"tertiary",isDestructive:!0,style:{marginTop:"10px"}},(0,i.__)("Bild entfernen","modular-blocks-plugin")),(0,n.createElement)(r.RangeControl,{label:(0,i.__)("Hintergrund-Höhe (px)","modular-blocks-plugin"),value:C,onChange:e=>l({backgroundHeight:e}),min:200,max:800})),(0,n.createElement)(r.PanelBody,{title:(0,i.__)("Einstellungen","modular-blocks-plugin")},(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Feedback anzeigen","modular-blocks-plugin"),checked:b,onChange:e=>l({showFeedback:e})}),(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Wiederholen erlauben","modular-blocks-plugin"),checked:h,onChange:e=>l({showRetry:e})}),(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Lösung anzeigen","modular-blocks-plugin"),checked:k,onChange:e=>l({showSolution:e})}),(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Sofortiges Feedback","modular-blocks-plugin"),checked:_,onChange:e=>l({instantFeedback:e})}),(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Snap aktivieren","modular-blocks-plugin"),checked:E,onChange:e=>l({enableSnap:e})}),(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Punktzahl anzeigen","modular-blocks-plugin"),checked:x,onChange:e=>l({showScore:e})}),(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Elemente zufällig anordnen","modular-blocks-plugin"),checked:v,onChange:e=>l({randomizeDraggables:e})}),(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Teilpunkte erlauben","modular-blocks-plugin"),checked:y,onChange:e=>l({allowPartialScore:e})})),(0,n.createElement)(r.PanelBody,{title:(0,i.__)("Ziehbare Elemente","modular-blocks-plugin"),initialOpen:!1},s.map((e,t)=>(0,n.createElement)(r.Card,{key:t,style:{marginBottom:"10px"}},(0,n.createElement)(r.CardHeader,null,(0,n.createElement)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"}},(0,n.createElement)("strong",null,e.content||`Element ${t+1}`),(0,n.createElement)(r.Button,{onClick:()=>(e=>{if(s.length<=1)return;const t=s.filter((l,t)=>t!==e);l({draggables:t})})(t),icon:d,variant:"tertiary",size:"small",isDestructive:!0}))),(0,n.createElement)(r.CardBody,null,(0,n.createElement)(r.SelectControl,{label:(0,i.__)("Typ","modular-blocks-plugin"),value:e.type,options:[{label:(0,i.__)("Text","modular-blocks-plugin"),value:"text"},{label:(0,i.__)("Bild","modular-blocks-plugin"),value:"image"}],onChange:e=>D(t,"type",e)}),(0,n.createElement)(r.TextControl,{label:(0,i.__)("Inhalt","modular-blocks-plugin"),value:e.content,onChange:e=>D(t,"content",e)}),(0,n.createElement)(r.TextControl,{label:(0,i.__)("Korrekte Zonen (Komma-getrennt)","modular-blocks-plugin"),value:e.correctZones.join(", "),onChange:e=>D(t,"correctZones",e.split(",").map(e=>e.trim())),help:(0,i.__)("IDs der Drop-Zonen","modular-blocks-plugin")}),(0,n.createElement)("div",{style:{marginTop:"10px"}},(0,n.createElement)("label",null,(0,i.__)("Farbe","modular-blocks-plugin")),(0,n.createElement)(r.ColorPicker,{color:e.color,onChangeComplete:e=>D(t,"color",e.hex)}))))),(0,n.createElement)(r.Button,{onClick:()=>{const e=[...s,{id:`drag${Date.now()}`,type:"text",content:`Element ${s.length+1}`,image:{url:"",alt:"",id:null},correctZones:[],color:"#0073aa",size:"medium"}];l({draggables:e})},icon:u,variant:"secondary"},(0,i.__)("Element hinzufügen","modular-blocks-plugin"))),(0,n.createElement)(r.PanelBody,{title:(0,i.__)("Drop-Zonen","modular-blocks-plugin"),initialOpen:!1},null!==z&&(0,n.createElement)(r.Notice,{status:"info",isDismissible:!1},(0,i.__)('Klicken Sie auf das Bild unten, um die Position der Zone "'+p[z]?.label+'" zu setzen.',"modular-blocks-plugin")),p.map((e,t)=>(0,n.createElement)(r.Card,{key:t,style:{marginBottom:"10px",backgroundColor:z===t?"#e7f5ff":"transparent"}},(0,n.createElement)(r.CardHeader,null,(0,n.createElement)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"}},(0,n.createElement)("strong",null,e.label),(0,n.createElement)("div",{style:{display:"flex",gap:"5px"}},(0,n.createElement)(r.Button,{onClick:()=>N(z===t?null:t),icon:m,variant:z===t?"primary":"secondary",size:"small",label:(0,i.__)("Position im Bild setzen","modular-blocks-plugin")}),(0,n.createElement)(r.Button,{onClick:()=>(e=>{if(p.length<=1)return;const t=p.filter((l,t)=>t!==e);l({dropZones:t})})(t),icon:d,variant:"tertiary",size:"small",isDestructive:!0})))),(0,n.createElement)(r.CardBody,null,(0,n.createElement)(r.TextControl,{label:(0,i.__)("ID","modular-blocks-plugin"),value:e.id,onChange:e=>Z(t,"id",e)}),(0,n.createElement)(r.TextControl,{label:(0,i.__)("Label","modular-blocks-plugin"),value:e.label,onChange:e=>Z(t,"label",e)}),(0,n.createElement)(r.RangeControl,{label:(0,i.__)("X Position (%)","modular-blocks-plugin"),value:e.x,onChange:e=>Z(t,"x",e),min:0,max:100}),(0,n.createElement)(r.RangeControl,{label:(0,i.__)("Y Position (%)","modular-blocks-plugin"),value:e.y,onChange:e=>Z(t,"y",e),min:0,max:100}),(0,n.createElement)(r.RangeControl,{label:(0,i.__)("Breite (px)","modular-blocks-plugin"),value:e.width,onChange:e=>Z(t,"width",e),min:50,max:300}),(0,n.createElement)(r.RangeControl,{label:(0,i.__)("Höhe (px)","modular-blocks-plugin"),value:e.height,onChange:e=>Z(t,"height",e),min:50,max:300}),(0,n.createElement)(r.ToggleControl,{label:(0,i.__)("Mehrere Elemente erlauben","modular-blocks-plugin"),checked:e.acceptMultiple,onChange:e=>Z(t,"acceptMultiple",e)})))),(0,n.createElement)(r.Button,{onClick:()=>{const e=[...p,{id:`zone${Date.now()}`,label:`Zone ${p.length+1}`,x:20+10*p.length,y:20+10*p.length,width:150,height:100,acceptMultiple:!1,backgroundColor:"rgba(0, 115, 170, 0.1)",borderColor:"#0073aa"}];l({dropZones:e})},icon:u,variant:"secondary"},(0,i.__)("Drop-Zone hinzufügen","modular-blocks-plugin"))),(0,n.createElement)(r.PanelBody,{title:(0,i.__)("Feedback-Texte","modular-blocks-plugin"),initialOpen:!1},(0,n.createElement)(r.TextControl,{label:(0,i.__)("Punktzahl-Text","modular-blocks-plugin"),value:w,onChange:e=>l({scoreText:e}),help:(0,i.__)("@score und @total werden ersetzt","modular-blocks-plugin")}),(0,n.createElement)(r.TextControl,{label:(0,i.__)("Erfolg-Text","modular-blocks-plugin"),value:f,onChange:e=>l({successText:e})}),(0,n.createElement)(r.TextControl,{label:(0,i.__)("Teil-Erfolg-Text","modular-blocks-plugin"),value:T,onChange:e=>l({partialSuccessText:e})}),(0,n.createElement)(r.TextControl,{label:(0,i.__)("Fehler-Text","modular-blocks-plugin"),value:S,onChange:e=>l({failText:e})}))),(0,n.createElement)("div",{...B},(0,n.createElement)("div",{className:"drag-and-drop-container"},(0,n.createElement)(r.TextControl,{label:(0,i.__)("Titel","modular-blocks-plugin"),value:t,onChange:e=>l({title:e})}),(0,n.createElement)(r.TextControl,{label:(0,i.__)("Beschreibung","modular-blocks-plugin"),value:a,onChange:e=>l({description:e})}),c.url&&(0,n.createElement)("div",{ref:P,onClick:e=>{if(null===z||!P.current)return;const l=P.current.getBoundingClientRect(),t=(e.clientX-l.left)/l.width*100,n=(e.clientY-l.top)/l.height*100;Z(z,"x",Math.max(0,Math.min(100,t))),Z(z,"y",Math.max(0,Math.min(100,n))),N(null)},style:{position:"relative",marginTop:"20px",height:`${C}px`,border:null!==z?"3px solid #0073aa":"1px solid #ddd",cursor:null!==z?"crosshair":"default",overflow:"hidden"}},(0,n.createElement)("img",{src:c.url,alt:c.alt,style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}}),p.map((e,l)=>(0,n.createElement)("div",{key:l,style:{position:"absolute",left:`${e.x}%`,top:`${e.y}%`,width:`${e.width}px`,height:`${e.height}px`,backgroundColor:e.backgroundColor,border:`2px solid ${e.borderColor}`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold",color:e.borderColor,pointerEvents:null!==z?"none":"auto",opacity:z===l?.8:.6,transform:"translate(-50%, -50%)"}},e.label))),(0,n.createElement)("div",{style:{marginTop:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"4px",background:"#f0f0f0"}},(0,n.createElement)("p",null,(0,n.createElement)("strong",null,(0,i.__)("Vorschau:","modular-blocks-plugin"))),(0,n.createElement)("p",null,(0,i.__)("Drag & Drop Aktivität mit "+s.length+" Elementen und "+p.length+" Zonen","modular-blocks-plugin")),(0,n.createElement)("p",{style:{fontSize:"12px",color:"#666"}},(0,i.__)("Die interaktive Funktionalität ist im Frontend verfügbar.","modular-blocks-plugin"))))))},save:({attributes:e})=>{const{title:l,description:t,backgroundImage:a,draggables:r,dropZones:c,showFeedback:s,showRetry:d,showSolution:u,instantFeedback:m,enableSnap:g,showScore:p,randomizeDraggables:b,allowPartialScore:h,backgroundHeight:k,scoreText:_,successText:E,partialSuccessText:x,failText:v}=e,y=o.useBlockProps.save(),C={draggables:r,dropZones:c,showFeedback:s,showRetry:d,showSolution:u,instantFeedback:m,enableSnap:g,showScore:p,randomizeDraggables:b,allowPartialScore:h,backgroundHeight:k,scoreText:_,successText:E,partialSuccessText:x,failText:v};return(0,n.createElement)("div",{...y,"data-drag-drop-config":JSON.stringify(C)},(0,n.createElement)("div",{className:"drag-and-drop-container"},l&&(0,n.createElement)("h3",{className:"drag-drop-title"},l),t&&(0,n.createElement)("p",{className:"drag-drop-description"},t),(0,n.createElement)("div",{className:"activity-area"},(0,n.createElement)("div",{className:"draggables-area"},(0,n.createElement)("h4",null,(0,i.__)("Elemente","modular-blocks-plugin")),(0,n.createElement)("div",{className:"draggables-container"},r.map((e,l)=>(0,n.createElement)("div",{key:l,className:`draggable-element draggable-${e.type}`,"data-draggable-id":e.id,draggable:"true"},"text"===e.type&&(0,n.createElement)("span",null,e.content),"image"===e.type&&e.image.url&&(0,n.createElement)("img",{src:e.image.url,alt:e.image.alt}))))),(0,n.createElement)("div",{className:"drop-area",style:{height:`${k}px`}},(0,n.createElement)("h4",null,(0,i.__)("Drop-Bereich","modular-blocks-plugin")),(0,n.createElement)("div",{className:"drop-area-container"},a.url&&(0,n.createElement)("img",{src:a.url,alt:a.alt,className:"background-image"}),(0,n.createElement)("div",{className:"drop-zones"},c.map((e,l)=>(0,n.createElement)("div",{key:l,className:"drop-zone","data-zone-id":e.id,style:{left:`${e.x}%`,top:`${e.y}%`,width:`${e.width}px`,height:`${e.height}px`}},(0,n.createElement)("div",{className:"zone-label"},e.label))))))),(0,n.createElement)("div",{className:"drag-drop-controls"},(0,n.createElement)("button",{type:"button",className:"drag-drop-button drag-drop-check"},(0,i.__)("Prüfen","modular-blocks-plugin")),d&&(0,n.createElement)("button",{type:"button",className:"drag-drop-button drag-drop-retry",style:{display:"none"}},(0,i.__)("Wiederholen","modular-blocks-plugin")),u&&(0,n.createElement)("button",{type:"button",className:"drag-drop-button drag-drop-solution",style:{display:"none"}},(0,i.__)("Lösung anzeigen","modular-blocks-plugin"))),p&&(0,n.createElement)("div",{className:"drag-drop-results",style:{display:"none"}},(0,n.createElement)("div",{className:"result-message"}),(0,n.createElement)("div",{className:"score-display"}))))}})})();