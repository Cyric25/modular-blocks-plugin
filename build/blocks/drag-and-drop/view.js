!function(){"use strict";window.initDragAndDrop=function(e){if(!e)return;const t=e.getAttribute("data-drag-drop-config");if(!t)return;const r=JSON.parse(t),o=(e.querySelector(".drag-and-drop-container"),e.querySelector(".draggables-container")),a=(e.querySelector(".drop-zones"),e.querySelector(".drag-drop-check")),n=e.querySelector(".drag-drop-retry"),l=e.querySelector(".drag-drop-solution"),s=e.querySelector(".drag-drop-results"),d=e.querySelector(".result-message"),c=e.querySelector(".score-display");let i=null,g={},u=!1;function f(e){u||(i=e.target,e.target.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target.innerHTML))}function p(e){e.target.classList.remove("dragging")}function y(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",e.target.classList.add("drag-over"),!1}function b(e){e.target.classList.remove("drag-over")}function h(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault();const t=e.target.closest(".drop-zone");if(!t||!i)return;t.classList.remove("drag-over");const a=t.getAttribute("data-zone-id"),n=i.getAttribute("data-draggable-id");if("true"!==t.getAttribute("data-accept-multiple")&&g[a].length>0){const e=t.querySelector(".draggable-element");e&&(o.appendChild(e),g[a]=[])}Object.keys(g).forEach(e=>{const t=g[e].indexOf(n);t>-1&&g[e].splice(t,1)});const l=i.cloneNode(!0);if(l.addEventListener("dragstart",f),l.addEventListener("dragend",p),r.enableSnap)t.appendChild(l);else{const r=t.getBoundingClientRect(),o=e.clientX-r.left,a=e.clientY-r.top;l.style.position="absolute",l.style.left=o+"px",l.style.top=a+"px",t.appendChild(l)}return i.remove(),g[a].push(n),r.instantFeedback&&function(e,t,o){const a=r.draggables.find(e=>e.id===t);if(!a)return;const n=a.correctZones.includes(o);e.classList.remove("correct","incorrect"),e.classList.add(n?"correct":"incorrect")}(l,n,a),i=null,!1}r.dropZones.forEach(e=>{g[e.id]=[]}),e.querySelectorAll(".draggable-element").forEach(e=>{e.addEventListener("dragstart",f),e.addEventListener("dragend",p)}),e.querySelectorAll(".drop-zone").forEach(e=>{e.addEventListener("dragover",y),e.addEventListener("drop",h),e.addEventListener("dragleave",b)}),a&&a.addEventListener("click",function(){u=!0;let t=0,o=r.draggables.length;r.draggables.forEach(r=>{let o=!1;Object.keys(g).forEach(t=>{if(g[t].includes(r.id)){const a=r.correctZones.includes(t),n=e.querySelector(`[data-zone-id="${t}"]`),l=n?.querySelector(`[data-draggable-id="${r.id}"]`);l&&(l.classList.remove("correct","incorrect"),l.classList.add(a?"correct":"incorrect")),a&&(o=!0)}}),o&&t++}),function(e,t){if(!s||!r.showScore)return;s.style.display="block";const o=e/t*100;let a="";if(a=100===o?r.successText:o>=50&&r.allowPartialScore?r.partialSuccessText:r.failText,d&&(d.textContent=a),c){const o=r.scoreText.replace("@score",e).replace("@total",t);c.textContent=o}}(t,o),e.querySelectorAll(".draggable-element").forEach(e=>{e.setAttribute("draggable","false"),e.style.cursor="default"}),a.style.display="none",n&&(n.style.display="inline-block"),l&&(l.style.display="inline-block")}),n&&n.addEventListener("click",function(){if(u=!1,e.querySelectorAll(".draggable-element").forEach(e=>{e.classList.remove("correct","incorrect","solution"),e.setAttribute("draggable","true"),e.style.cursor="move",e.style.position="",e.style.left="",e.style.top="",o.appendChild(e)}),Object.keys(g).forEach(e=>{g[e]=[]}),r.randomizeDraggables){const e=Array.from(o.children);e.sort(()=>Math.random()-.5),e.forEach(e=>o.appendChild(e))}s&&(s.style.display="none"),a.style.display="inline-block",n&&(n.style.display="none"),l&&(l.style.display="none")}),l&&l.addEventListener("click",function(){for(e.querySelectorAll(".drop-zone").forEach(e=>{for(;e.firstChild&&e.firstChild.classList?.contains("draggable-element");)e.removeChild(e.firstChild)}),r.draggables.forEach(t=>{if(t.correctZones.length>0){const r=t.correctZones[0],a=e.querySelector(`[data-zone-id="${r}"]`),n=o.querySelector(`[data-draggable-id="${t.id}"]`)||e.querySelector(`[data-draggable-id="${t.id}"]`);if(a&&n){const e=n.cloneNode(!0);e.classList.add("solution"),e.classList.remove("correct","incorrect"),e.setAttribute("draggable","false"),e.style.cursor="default",a.appendChild(e)}}});o.firstChild;)o.removeChild(o.firstChild);s&&r.showScore&&(s.style.display="block",d&&(d.textContent="LÃ¶sung wird angezeigt."),c&&(c.textContent="")),l&&(l.style.display="none")})},document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".wp-block-modular-blocks-drag-and-drop").forEach(e=>{window.initDragAndDrop(e)})})}();