(()=>{"use strict";const e=window.React,l=window.wp.blocks,t=window.wp.blockEditor,a=window.wp.components,n=window.wp.i18n,r=window.wp.element;function o({chartType:l,chartData:t,setAttributes:o}){const[i,s]=(0,r.useState)("1, 2, 3, 4, 5"),[c,m]=(0,r.useState)("10, 15, 13, 17, 20"),[u,p]=(0,r.useState)("Datensatz 1");return(0,e.createElement)(a.TabPanel,{className:"chart-data-tabs",tabs:[{name:"json",title:(0,n.__)("JSON","modular-blocks-plugin")},{name:"csv",title:(0,n.__)("CSV Import","modular-blocks-plugin")},{name:"manual",title:(0,n.__)("Manuelle Eingabe","modular-blocks-plugin")}]},r=>"json"===r.name?(0,e.createElement)("div",null,(0,e.createElement)(a.Notice,{status:"info",isDismissible:!1},(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,n.__)("JSON Format-Beispiel:","modular-blocks-plugin"))),(0,e.createElement)("pre",{style:{fontSize:"11px",background:"#f5f5f5",padding:"10px",borderRadius:"4px",overflow:"auto"}},'[{\n  "x": [1, 2, 3, 4, 5],\n  "y": [10, 15, 13, 17, 20],\n  "type": "scatter",\n  "name": "Datensatz 1"\n}]')),(0,e.createElement)(a.TextareaControl,{label:(0,n.__)("Chart-Daten (JSON)","modular-blocks-plugin"),value:t,onChange:e=>o({chartData:e}),help:(0,n.__)("Geben Sie Plotly.js-kompatible Daten als JSON ein","modular-blocks-plugin"),rows:12})):"csv"===r.name?(0,e.createElement)("div",null,(0,e.createElement)("p",null,(0,n.__)("CSV-Datei importieren:","modular-blocks-plugin")),(0,e.createElement)("input",{type:"file",accept:".csv",onChange:e=>{const l=e.target.files[0];if(l){const e=new FileReader;e.onload=e=>{const l=function(e){const l=e.trim().split("\n");if(l.length<2)return[];const t=l[0].split(",").map(e=>e.trim()),a=[];for(let e=1;e<t.length;e++)a.push({x:[],y:[],name:t[e],type:"scatter"});for(let e=1;e<l.length;e++){const t=l[e].split(",").map(e=>e.trim()),n=parseFloat(t[0]);if(!isNaN(n))for(let e=1;e<t.length&&e-1<a.length;e++){const l=parseFloat(t[e]);isNaN(l)||(a[e-1].x.push(n),a[e-1].y.push(l))}}return a}(e.target.result);o({chartData:JSON.stringify(l,null,2)})},e.readAsText(l)}},style:{width:"100%",padding:"8px",marginTop:"8px"}}),(0,e.createElement)(a.Notice,{status:"info",isDismissible:!1,style:{marginTop:"12px"}},(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,n.__)("CSV Format:","modular-blocks-plugin"))),(0,e.createElement)("p",{style:{fontSize:"11px",marginTop:"6px"}},(0,n.__)("Erste Zeile = Spaltennamen","modular-blocks-plugin"),(0,e.createElement)("br",null),(0,n.__)("Erste Spalte = X-Werte","modular-blocks-plugin"),(0,e.createElement)("br",null),(0,n.__)("Weitere Spalten = Y-Werte (eine Spalte pro Datensatz)","modular-blocks-plugin")),(0,e.createElement)("pre",{style:{fontSize:"11px",background:"#f5f5f5",padding:"8px",borderRadius:"4px",marginTop:"8px"}},"X,Datensatz 1,Datensatz 2\n1,10,8\n2,15,12\n3,13,14\n4,17,16\n5,20,18"))):"manual"===r.name?(0,e.createElement)("div",null,(0,e.createElement)(a.TextControl,{label:(0,n.__)("Name des Datensatzes","modular-blocks-plugin"),value:u,onChange:e=>p(e)}),(0,e.createElement)(a.TextareaControl,{label:(0,n.__)("X-Werte (kommagetrennt)","modular-blocks-plugin"),value:i,onChange:e=>s(e),help:(0,n.__)("Beispiel: 1, 2, 3, 4, 5","modular-blocks-plugin"),rows:2}),(0,e.createElement)(a.TextareaControl,{label:(0,n.__)("Y-Werte (kommagetrennt)","modular-blocks-plugin"),value:c,onChange:e=>m(e),help:(0,n.__)("Beispiel: 10, 15, 13, 17, 20","modular-blocks-plugin"),rows:2}),(0,e.createElement)(a.Button,{variant:"primary",onClick:()=>{const e=[{x:i.split(",").map(e=>parseFloat(e.trim())).filter(e=>!isNaN(e)),y:c.split(",").map(e=>parseFloat(e.trim())).filter(e=>!isNaN(e)),type:"3d"===l?"scatter3d":l,name:u}];o({chartData:JSON.stringify(e,null,2)})}},(0,n.__)("Daten übernehmen","modular-blocks-plugin"))):void 0)}(0,l.registerBlockType)("modular-blocks/chart-block",{edit:({attributes:l,setAttributes:r})=>{const{chartType:i,chartData:s,chartTemplate:c,chartTitle:m,xAxisLabel:u,yAxisLabel:p,showLegend:g,width:d,height:b}=l,h=(0,t.useBlockProps)();return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.InspectorControls,null,(0,e.createElement)(a.PanelBody,{title:(0,n.__)("Diagramm-Typ","modular-blocks-plugin")},(0,e.createElement)(a.SelectControl,{label:(0,n.__)("Diagramm-Typ","modular-blocks-plugin"),value:i,options:[{label:(0,n.__)("Streudiagramm","modular-blocks-plugin"),value:"scatter"},{label:(0,n.__)("Balkendiagramm","modular-blocks-plugin"),value:"bar"},{label:(0,n.__)("Liniendiagramm","modular-blocks-plugin"),value:"line"},{label:(0,n.__)("Heatmap","modular-blocks-plugin"),value:"heatmap"},{label:(0,n.__)("3D","modular-blocks-plugin"),value:"3d"}],onChange:e=>r({chartType:e})}),(0,e.createElement)(a.SelectControl,{label:(0,n.__)("Chemie-Vorlage","modular-blocks-plugin"),value:c,options:[{label:(0,n.__)("Keine Vorlage","modular-blocks-plugin"),value:""},{label:(0,n.__)("Titration","modular-blocks-plugin"),value:"titration"},{label:(0,n.__)("Kinetik","modular-blocks-plugin"),value:"kinetics"},{label:(0,n.__)("Phasendiagramm","modular-blocks-plugin"),value:"phase"},{label:(0,n.__)("Lineweaver-Burk","modular-blocks-plugin"),value:"lineweaver"},{label:(0,n.__)("IR-Spektroskopie","modular-blocks-plugin"),value:"ir"}],onChange:e=>r({chartTemplate:e}),help:(0,n.__)("Wählen Sie eine Vorlage für häufige Chemie-Diagramme","modular-blocks-plugin")})),(0,e.createElement)(a.PanelBody,{title:(0,n.__)("Beschriftungen","modular-blocks-plugin")},(0,e.createElement)(a.TextControl,{label:(0,n.__)("Diagramm-Titel","modular-blocks-plugin"),value:m,onChange:e=>r({chartTitle:e})}),(0,e.createElement)(a.TextControl,{label:(0,n.__)("X-Achsen-Beschriftung","modular-blocks-plugin"),value:u,onChange:e=>r({xAxisLabel:e})}),(0,e.createElement)(a.TextControl,{label:(0,n.__)("Y-Achsen-Beschriftung","modular-blocks-plugin"),value:p,onChange:e=>r({yAxisLabel:e})}),(0,e.createElement)(a.ToggleControl,{label:(0,n.__)("Legende anzeigen","modular-blocks-plugin"),checked:g,onChange:e=>r({showLegend:e})})),(0,e.createElement)(a.PanelBody,{title:(0,n.__)("Größe","modular-blocks-plugin")},(0,e.createElement)(a.RangeControl,{label:(0,n.__)("Breite (px)","modular-blocks-plugin"),value:d,onChange:e=>r({width:e}),min:400,max:1200}),(0,e.createElement)(a.RangeControl,{label:(0,n.__)("Höhe (px)","modular-blocks-plugin"),value:b,onChange:e=>r({height:e}),min:300,max:800})),(0,e.createElement)(a.PanelBody,{title:(0,n.__)("Daten","modular-blocks-plugin"),initialOpen:!1},(0,e.createElement)(o,{chartType:i,chartData:s,setAttributes:r}))),(0,e.createElement)("div",{...h},(0,e.createElement)("div",{className:"chart-block-container"},(0,e.createElement)("div",{className:"chart-preview",style:{width:`${d}px`,height:`${b}px`,border:"1px solid #ddd",padding:"20px"}},(0,e.createElement)("h3",{style:{textAlign:"center",marginBottom:"10px"}},m),(0,e.createElement)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"calc(100% - 40px)",background:"#f5f5f5"}},(0,e.createElement)("div",{style:{textAlign:"center"}},(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,n.__)("Diagramm-Vorschau","modular-blocks-plugin"))),(0,e.createElement)("p",{style:{fontSize:"12px",color:"#666",marginTop:"10px"}},c?(0,n.__)("Vorlage: "+c,"modular-blocks-plugin"):(0,n.__)("Typ: "+i,"modular-blocks-plugin")),(0,e.createElement)("p",{style:{fontSize:"12px",color:"#666"}},(0,n.__)("Das interaktive Diagramm wird im Frontend mit Plotly.js gerendert","modular-blocks-plugin"))))))))},save:({attributes:l})=>{const{chartType:a,chartData:n,chartTemplate:r,chartTitle:o,xAxisLabel:i,yAxisLabel:s,showLegend:c,width:m,height:u}=l,p=t.useBlockProps.save(),g={chartType:a,chartData:n,chartTemplate:r,chartTitle:o,xAxisLabel:i,yAxisLabel:s,showLegend:c,width:m,height:u};return(0,e.createElement)("div",{...p,"data-chart-config":JSON.stringify(g)},(0,e.createElement)("div",{className:"chart-block-container"},(0,e.createElement)("div",{className:"chart-viewer",style:{width:`${m}px`,height:`${u}px`},"aria-label":o})))}})})();